#### 网络层的两种设计思路
| 设计方案 | 虚电路 | 数据报 |
| --------------- | --------------- | --------------- |
| 思路 | 可靠的服务由网络叞负责 | 可靠的通信由主机负责 |
| 连接状态 | 有 | 无 |
| 目标地址  | 只在建立连接时使用 | 由每一个分组携带 |
| 分组转发过程  | 分组在同一条虚拟电路 | 每一介分组自己查找转发路径 |
| 节点出现故障时  | 所有关联该节点的连接失效 | 由该节点处理的分组失效 |
| 连接上的差错控制  | 由网络层负责 | 由主机端负责 |


#### 网络层的两个层面

两个层面从路由器面言的。路由器要处理的信息分为两类：由端到端的信息，与其仓路由器合作更新路由转发表的交换信息。
路由器对这两种信息处理方式抽象出了两层：数据层和控制层

#### Inernet protocle

##### 虚握住互连网络
- 不同网络的寻址方式
- 不同网络之间分组的长度
- 不同的超时机制
- 不同的差错恢复方法
- 不同的状态报告方式
- 不同的用户接入方式
- 不同的路由选择方式
- 有无连接状态
- 不同的管理与控制方式


##### IP地址
IP地址被定久为长度为32位的二进制数。其中高n(0 <= n <= 32)位表示主机在网络中的位置信息，后32-n位表示主机在该网络中的位置信息。
数据的格式本质是信息的结构。即信息的构成与各部分之间的先后关系.

##### IP地址的分类
分类IP地坦是在原始的IP数据表示法的基础上，加入了对其元信息表示的新表示法,这里的元信息是IP数据中网络号的长度。
这种表示法可以表示有限种网络号长度的IP信息。殚体的方法是在高使用几个bit表示该IP地址类型.即该IP中网络号的长度。

为什么为IP地址分类？
IP地址的分类本质上是如何关联IP地址中网络号长度这个元信息的问题。第一种方式采用了将这一数据嵌入到IP地址中的方式，这种方弎实现起来相对简单，先预设几种常用的肉络号长度，再在IP地址中使用几个bit位表示这些预设的信息就可以了。
另一仲方式是用独立的一个数据来表示这个信息，当前IP地址中肉络号的取值范围是0 - 32位，因此按理说只需5bit即可完成这一信息的表示，但实际应用中使用32位的编码方式。这是因为在实际中常需执行将IP地址 + 网络长度转化为网络号的动作，而为了提高转化速度，实际中使用了32位的特殊纊码方式，而不是相对简单直接使用5bit位编码对应的阿拉伯数字。


#####  为什么需要IP地址
在网络层中，向下交付数据报时，需要将IP地址转化为IP地址。即如緯，我们为什么还需要IP地址呢？
我的想法：
因为IP地址的数据结构是树状的，而MAC地址的数据结构是平面的，这里的数据结构指的是数据的构成方式。IP地址这一数据可以分解为网络号与主机号，而MAC地址无法向下分解，仅由其本身构成。而它们都是用于描述互联网中的主机的位置信息的，很显然IP地址对位置信息的描述更为精细，这址接导致了使用IP地址与MAC地址进行网络寻址操作时，它们之间的速度差异十分大，以及，IP地址比MAC地址有着更好的数据聚合能力。这也是导致了使用IP地址替代MAC寻址的主要原因。
即如此，我有一个新的疑问，在查找与聚合能输力上，IP地址都优于MAC地址，为什么IP地址没有全面替代MAC呢？或者说MAC有哪些IP没有的独特优势？

##### IP数据报的首部结构
- 版本：这一字段的长度为4位。语义是当前数据报所使用的IP协议的版本。辅助接收方程序选择处理这个数据报的方式。
- 首部长度：这一字段的长度为4bit，其语义为首部的长度，特别注意的是其单位为4字节。之所以单位不是预期的1字节，是因为IP数据报的首部中有20字节的固定内容，如果使用1字节为单位，那么，这字段的最短为5bit，因为首部中固定部分的长度是20字节。但是我们为什么不用20字节作为单位呢？这样就可以使用1bit来描述首部部分的大小了。这是因为使用20字节作为单位时，当可选字段的长度不足20字节时，需要用0来填充这部分，而在实际使用中可选字段的长度都4——8字段左右。此时需要填充的0bit比多，因此造成的空间浪费大。
- 区分服务：这个字段的长度为1字节。其语义为
- 总长度：这个字段的长度为16bit, 语义是这个数据报的总长度。这个信息在向下交付给鏈路层时，会用其来进行是否分片的判断。
- 标识：这个字段长度是16bit, 语义是该数据报与那些是同一个数据报的不同分片。该信息在接收方接收由下层提供的数据报，执行数据报合并时，詥我用。
- 标志：字段长度是3位。语义是【该数据报是最后一介分片】、【该数据报不是最后一个分片】、【该数据报是否可以分片】等。这个信息在接收方进行分片合并的时候被使用。
- 协议：长度为8位。用于告知拉收方，用什科协议来处理这个数据包中的数据部分。
- 转发次数：字段长広为8位。语义是该数据报在网络中允许经过的路由器的最大次数。这个字段由发送方设置，主要作用是为了避免该数据报在网络中死循环，浪费网络资源。

##### IP分组的转发过程
关键概念：路由器，路由，路由表
。
而是取出数据报中的IP地址，然后用每一个表项中的mask求and，最后捍结榥与该表项中的网段是否相等？我不是很能理解这一行为？计算机肉络为什么不能如此设计？

路幅器的工作过程为什么不是取出接收数据报中的IP地址与对应mask,然后，and得网段，最后用网段在路由表中作为关键字查找
为什么不这样设计的原因：这样的设计有问题。因肉络的层次结构，导致一个IP地址可对应多个掩码，即在不同大小的网络中。在使用此种方式执行路由的第一个问题是：用什么掩码来与目的IP地址进行and操作，但是最本质的问题在于：目的IP地址有两个来源：1. 来自于用户的输入，当用户想访问某一个网站时，只会输入目标网站的域名(可读的IP地址），因此，数据报中是没有目标地址相关的掩码信息的。2. 来自于请求报文的来源地址，计算机在生成响应报文时，会使用请求报文中的来源地址作为目标地址，而其同样也是没有相关掩码的。所以，这种转发方式是不符合实际的。

路由器的转私过程描述：
1. 路由器接收到一个分组，先众该分组中取出目地IP地址，
2. 尝试匹配静态路由，匹配成功，则按静态路由中的下一跳与接口信息进行转发。反之，则执行2
3. 匹配路由表中的第一行，取出其中的掩码，与目标地址执行and运算，再将结果与该条路由中的网络号配对，成功，则用该条路由中的下一跳与接口信息执行转发，反之，执行4
4. 判断是否还有下一条路由，有，则执行3, 反之，执行5
5. 尝试匹配默认路由，成功，用默认路由进行转发，否则，丢弃
反驳我的看法

#### ICMP

#### IPv6
为什么需要IPv6?
IPv6与IPv4的异同？

#### 路由近代制协议
对于任一个路由控制协议。可统一分为四部分内容：1.跟谁交换信息 2.交换什么信息 3.什么时候交换信息 4.如何更新信息
1. RIP
    - 只与相邻的结点交换信息。（即两者之间的通信不经过第三方，即为相邻）
    - 交换当前路由表内所有的（网络，跳数，下一跳）三元组信息。
    - 定时每隔一定的时间进行信息交换。
    - 信息更新方式：
        - 对获取到的信息进行预处理。将距离加一，下一跳更新为X(即该条信息的来源)。在自身的路由表中找到网络地址相同的条目。若找到。则执行下一步，反之，则将其添加到表中。
        - 判断本地三元组中的下一跳是否为X. 是，则更新，反之，执行下一步。
        - 判断本地三元组中的跳数与外部三元组中跳组中跳数的大小关系：大于：则更新。反之，丢弃外部三元组。
    - 更新香草法合理性分析：
        - 首先RIP协议的优质路由的判断标准基于跳数的大小。在算法第一步中修改外部路由的行为可理解为对外部信息的本地化。因为这些外部信息是在本地路由器中使用的，因此本地化是必要的，只有本地化后的外部信息与本地信息进行“优胜小劣汰”才有意义。
        - 先匹配本地路由中的下跳与本地化后下一跳的合理性在于：基于前一步本地化外部路由会导致一旦选择了某条趷由。则这路由一定是来自于该路由中下一跳所指的路由器。那么，一旦本地化后的外部路由与所匹配的本地路由有查同的下一跳，则这两条路由一定来斖于同一路由器。而该条外部路由作为此路由器到目标网络的最新路由，基一定是等于或优于本地的该条路由的。（建立在RIP有效正确的前提下）
        - 在下一跳不匹配的情况下，说明了外部路由与本地路由不来斖同一路由器。这直接使用距离这一项进行比较即可。

反驳我的观点？


#### ICMP 报文的结构
1. 类型字段：
2. 代码字段：
3. 检验和字段：
4. ：


#### 地址解析协议

##### ARP是什么
ARP协议的全称是Address Resolve Protocol. 作用是将给定的IP地址转化为该网络中的MAC地址。使用ARP的场景有四种，分别是：
- 主机向同网络内的另一台主机发送数据时。
- 主机向另一个网络中的主机发送数据时。
- 路由器向同一个网络中的生机发送数据。
- 路由器向相连的另一台路由器发送数据

##### ARP的工作方法

ARP的工作过程：
1. 每一台机器都有一个ARP缓存，用于记录同一网络中主机IP椟址到MAC地址的映射表
2. 当ARP协议工作时，会以目标主机的IP为key,在这个映射表中查找对应的条目.会有两种结果。一是找到了对应的条目，二是没有找到对应的条目。在第一种情况中，ARP返回对应的MAC地址。
在第二种情况中，ARP协议会向此网络中发送一个广播报文，当同网络中的一台主机接收到此报文时，会进行一个判断，此报文中所请求的IP地址与生己是否相同，若不相同，则妻丢弃该报文，反之，则以生己的MAC地址作为响应内容，进行响应。
请求生机在接收入到响应之后，更新主身的ARP缓存

这是我关于ARP工作过程的看法，请反驳我的观点

### question

在IP数据包首部中有可选字段，这些可选字段的长度如果是可变的，那么在接收方用怎样的方式来处理这些可选字段？
IP地址琚MaC地址的异同
为什么在计算机网络中，IP地址这仲地址数据没有全面替代Mac这仲数据？
但是我有一个问题。
ICMP是什么？有什么用？为什么需要它？

